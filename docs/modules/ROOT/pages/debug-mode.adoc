= Debug mode
:page-role: guide

This page explains how developers can exercise the Recomma binary without completing the normal WebAuthn vault ceremony. Debug mode is designed for local experiments, feature development, and automated tests. It should never be enabled in environments that handle real funds.

[NOTE]
====
Debug mode requires compiling with the `debugmode` build tag:

```
go build -tags debugmode ./cmd/recomma
```

Production builds (without `-tags debugmode`) do not include debug mode capabilities.
====

== How debug mode works

Debug mode is implemented as a separate build variant with its own `main()` function. When the binary is compiled with `-tags debugmode` and the required environment variables are present:

* the application loads vault credentials from `RECOMMA_DEBUG_*` environment variables at startup;
* it calls the production `VaultController.Unseal()` API programmatically with the loaded credentials;
* the vault transitions to *Unsealed* state without user interaction; and
* all services start normally as if the vault was unsealed through the Web UI.

Important: Debug mode uses the same production code paths for vault unsealing. The only difference is that credentials come from environment variables instead of WebAuthn authentication.

== Required environment variables

Provide the same secrets you would normally store through the vault, but via environment variables that start with `RECOMMA_DEBUG_`. All of them are required; the process aborts if any value is missing or empty.

[cols="1,3",options="header"]
|===
| Variable | Purpose
| `RECOMMA_DEBUG_THREECOMMAS_API_KEY` | Public API key for 3Commas requests.
| `RECOMMA_DEBUG_THREECOMMAS_PRIVATE_KEY` | PEM-encoded private key that signs 3Commas requests.
| `RECOMMA_DEBUG_THREECOMMAS_PLAN_TIER` | 3Commas subscription tier (`starter`, `pro`, or `expert`) used to configure client rate limits. Defaults to `expert` when omitted.
| `RECOMMA_DEBUG_HYPERLIQUID_WALLET` | Hyperliquid wallet address used for submissions and subscriptions.
| `RECOMMA_DEBUG_HYPERLIQUID_PRIVATE_KEY` | Hyperliquid signing key corresponding to the debug wallet.
| `RECOMMA_DEBUG_HYPERLIQUID_URL` | Base URL for the Hyperliquid endpoint (for example `https://api.hyperliquid.xyz`). Must be a valid URL.
|===

Each variable is trimmed before use. URL validation rejects obvious typos to avoid confusing connection errors later in startup.

== Enabling debug mode

. Export the required environment variables. Store development-only credentials in a `.env.debug` file or your shell profile. Never reuse production keys.
. The file `.env.debug` will automatically be loaded if present in the same working directory as the binary.
. Build or run the binary with the `debugmode` tag:
+
[source,bash]
----
go build -tags debugmode ./cmd/recomma
----
+
Or run directly:
+
[source,bash]
----
RECOMMA_DEBUG_THREECOMMAS_API_KEY=... \
RECOMMA_DEBUG_THREECOMMAS_PRIVATE_KEY="$(cat private.pem)" \
RECOMMA_DEBUG_THREECOMMAS_PLAN_TIER=expert \
RECOMMA_DEBUG_HYPERLIQUID_WALLET=... \
RECOMMA_DEBUG_HYPERLIQUID_PRIVATE_KEY=... \
RECOMMA_DEBUG_HYPERLIQUID_URL=https://example.hyperliquid.dev \
go run -tags debugmode ./cmd/recomma --public-origin=http://localhost:8080
----
+
. The binary will automatically unseal the vault from environment variables at startup.

TIP: When scripting tests, inject the environment variables directly into the process instead of writing them to disk.

== Interacting with the API in debug mode

The debug mode binary behaves identically to production once the vault is unsealed. The Web UI and API work normally - authentication and session cookies function as they would in production.

The key differences:

* Vault is automatically unsealed at startup (no WebAuthn required)
* Credentials come from environment variables instead of encrypted storage
* The `cfg.Debug` flag may enable additional logging or relaxed validation

== Limitations and cautions

* Secrets stay in memory for the entire process lifetime. There is no reseal flow or passkey protection.
* The auto-unsealed vault contains production-like credentials but should never handle real funds.
* Debug mode bypasses the strongest security guarantees of Recomma. Keep it behind firewalls and avoid connecting wallets with transferable value.

To return to normal operations, rebuild the binary without `-tags debugmode` and use the standard WebAuthn vault flow.
